{% extends 'base.html.twig' %}

{% block title %}Produto index{% endblock %}

{% block body %}


    <h1>Produto index</h1>
    {% if app.user %}
        <div class="mb-3 logout">
            You are logged in as {{ app.user.userIdentifier }}, <a href={{ path('app_logout') }}>Logout?</a>
        </div>
    {% else %}
        Register to more privileges:</br>
        <a href={{ path("app_login", parameters = []) }}> <button>Go to login</button> </a>
    {% endif %}

    <table class="table">
        <thead>
            <tr>
                <th>Id</th>
                <th>Name</th>
                <th>Amount</th>
                <th>Datetime</th>
                <th>actions</th>
            </tr>
        </thead>
        <tbody>
        {% for produto in produtos %}
            <tr>
                <td>{{ produto.id }}</td>
                <td>{{ produto.name }}</td>
                <td>{{ produto.amount }}</td>
                <td>{{ produto.datetime ? produto.datetime|date('Y-m-d H:i:s') : '' }}</td>
                <td>
                    <div class="left-end">
                    <a href={{ path('app_home_show', {'id': produto.id}) }}> <button class="btn btn-outline-info">show</button> </a>
                    {% if app.user %}
                        {% if app.user.roles.0 in ["ROLE_NORMAL_USER", "ROLE_ADMIN"] %}
                            <a href={{ path('app_home_edit', {'id': produto.id}) }}> <button class="btn btn-outline-dark">edit</button> </a> 
                        {% endif %}
                    {% endif %}
                    </div>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="5">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>    

    {% if app.user %}
        {% if app.user.roles.0 == "ROLE_ADMIN" %}
            <a href={{ path('app_home_new') }}><button class="btn btn-outline-success-">Create new</button></a>
        {% elseif app.user.roles.0 == "ROLE_NORMAL_USER" %}
            you can become admin for more privileges: </br>
            <a href={{ path("app_charge_to_admin") }}><button class="btn btn-outline-success">Go to admin regiser</button></a>
        {% endif %}
    {% endif %}

{% endblock %}
